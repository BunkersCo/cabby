#!/usr/bin/env python

import os
import re
import calendar
from datetime import datetime

from taxii_client.script_commons import run_client, configure_color_logging

import logging

log = logging.getLogger('taxii-discovery')


def extend_arguments(parser):
    return parser


def runner(client, path, args):

    services = client.discover_services(uri=path)

    for s in services:
        if args.as_xml:
            print s.to_xml()
        else:
            print s.to_text()

if __name__ == '__main__':
    run_client(extend_arguments, runner)

    


